	Fourfit Output Documentation
	----------------------------


    Data output is performed by the output() routine. This routine breaks
    up the output into several different tasks described below :

    out_plot() - This routine generates all the points for the graphs 
		 which are displayed on the fringeplot, as well as other results
		 that follow directly from these calculations. The data to be graphed
		 is stored in the the type_plot structure 'plot'. 

		 Out_plot() summary
		 -----------------

		 Delay rate spectrum -- The delay rate spectrum is calculated at the residual
		 multiband delay value for the maximum delay channel, and is averaged  over 
		 all frequencies. It is calculated by counter-rotating (with vrot() ) the 
		 singleband delay values (maximum delay channel) for each accumulation record
		 and summing these over all frequencies. An FFT across time is taken to generate a
		 delay rate spectrum.
				 nfreq
		 D[dr] = FFT   ( SUM  D[sbd_max,fr,t] *  VROT(t,R,G,fr,sb)  )
			(time)  fr=0

			R= delay rate
			G = group delay
			sb = sideband
			sbd = maximum single band delay channel

		 Multiband delay spectrum -- The multiband delay spectrum is calculated at the residula
		 delay rate for the maximum delay channel and is averaged over time. It is calculated by
		 again counter-rotating the singleband delay values for each accumulation record
		 This time, however, no rotation is made for multiband delay, and the results are  
		 summed across time. These values are then FFT'd across frequency (using the same spacing as in
		 the original search) to obtain the multiband spectrum.

		 D[mbd] = FFT    ( SUM D[sbd_max,fr,t] * VROT(t,R, G=0, fr, sb) )
			 (freq)    t=0


		 Single band delay spectrum, Cross Power Spectrum, and Single band delay box --
		 The single band delay spectrum is averaged across all frequencies and times.
		 It is generated by counter-rotating (with vrot() ) for the observed residual values,
		 and, for each delay channel, summing across time and frequency. The cross-power spectrum
		 is obtained by taking the FFT of this across time(delay), and counter-rotating to remove the
		 singleband delay. For each frequency, the singleband delay box is calculated by summing
		 the counter-rotated singleband delay values across time, and finding the maximum delay channel
		 for each frequency. A parabolic interpolation is then performed through this point and the two
		 delay channels on either side, to find the peak singleband delay channel.

		 D[sbd] = SUM  SUM D[sbd,fr,t] * VROT(t, R, G, fr, sb)
			 fr=0  t=0

		 XP[w]  = ( FFT  D[sbd] )   * exp (-PI * i * sbd_max * (w-8) / 16)
			   (sbd)

		 SB[fr,sbd] = SUM D[sbd,ft,t] * VROT(t,r,G,fr,sb)
			      t=0
		        
			for each freq, find sbd which maximizes SB, and interpolate around it.

		
		Fringe phasors -- Fringe phasors are computed for every time and frequency, by
		counter-rotating the single band delay value (max. delay channel) for that accumulation record
		by vrot() at the calculated residuals. Coherent averages of fringe phase and amplitude are calculated
		for each frequency and stored in status.fringe[freq]. Incoherent averages are also made  - some of these
		may disagree with FRNGE incoherent averages, due to different segmentation.

		FRINGE[fr,t] = D[sbd_max,fr,t] * VROT(t, R, G, fr, sb)


	
    Out_fringe()  -- Outfringe() calculates all remaining values which will be either
		printed on the fringeplot or placed in the fringe record. Documentation for
		these calculations can be found in the code, since most are rather straight-forward.

    Out_disk()  -- This routine transfers the information in the fringe structure to disk in 
		the form of a Type 52 fringe record.


    
    Output data structures
    ----------------------

    Output values can be found ine one of three places - the type_status structure, the type_plot structure
    or the type_fringe structure. The fringe structure contains all the information that will be saved
    in the fringe record, the plot structure contains all the points for the graphs that appear on the
    fringeplot, and the status structure contains everything else that is needed for the fringeplot, as well 
    as other quantities search() calculated along the way.
	 The only information that is saved directly is that contained in the fringe structure. However,
    an ASCII representation of the fringeplot is available in the fringe record. This means, though, that a 
    new XGraph display can not be generated without re-running Fourfit.
